<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"> 

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"> 
  <head>
    <title>Page Monitor Popup</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="styles/popup.css" />
    <script type="text/javascript" src="lib/jquery-1.4.1.js"></script> 
    <script type="text/javascript" src="scripts/base.js"></script>
    <script type="text/javascript" src="scripts/popup.js"></script>
    <script type="text/javascript">
      $(function() {
        // Insert translations.
        $('.i18n').each(function() {
          $(this).removeClass('i18n')
                 .text(chrome.i18n.getMessage($(this).attr('title')))
                 .attr('title', '');
        });
      
        // Turn off animations if they are disabled.
        if (getSetting(SETTINGS.animations_disabled)) $.fx.off = true;
      
        // Mark external links with target=_blank to open them in a new window.
        $('#options').add('#feedback').attr('target', '_blank');
      
        // "Monitor this page" handler.
        $('#monitor_page').click(monitorCurrentPage);
        
        // "Check All Now" handler.
        $('#check_now').click(checkAllPages);
        
        // Handlers to mark the page visited.
        $('.mark_visited').live('click', markPageVisited);
        $('.view_diff').live('click', openExternalLink);
        $('.page_link').live('click', openExternalLink);
        
        // "Stop monitoring" live click handler.
        $('.stop_monitoring').live('click', function() {
          var url = getNotificationUrl(this);
          markPageVisited.call(this);
          removePage(url);
        });
        
        // Mark page monitored if it is (initially).
        chrome.tabs.getSelected(null, function(tab) {
          isPageMonitored(tab.url, setPageMonitoredStatus);
        });
        
        // Initially fill the notification table.
        fillNotifications();
      });
    </script>
  </head>
  <body>
    <table id="templates">
      <tr class="notification">
        <td>
          <div class="page_info">
            <img class="favicon" src="img/page.png" alt="Favicon" />
            <a class="page_link" href="#">Page</a>
          </div>
          <div class="page_controls">
            <span class="util active stop_monitoring">
              <img src="img/stop_monitoring.png" alt="Stop Monitoring" />
              <span class="i18n" title="stop_monitoring"></span>
            </span>
            <span class="util active mark_visited">
              <img src="img/mark_visited.png" alt="Mark Visited" />
              <span class="i18n" title="mark_visited"></span>
            </span>
            <a class="util active view_diff" href="#">
              <img src="img/diff.png" alt="View Diff" />
              <span class="i18n" title="view_diff"></span>
            </a>
          </div>
        </td>
      </tr>
      <tr class="empty">
        <td>
          <span class="i18n" title="no_changes"></span>
        </td>
      </tr>
      <tr class="loading_spacer">
        <td>
          &nbsp;
        </td>
      </tr>
    </table>
        
    <table id="notifications" cellspacing="0">
      <!-- Notification entries go here. -->
    </table>
    <hr />
    <p class="main_controls">
      <a class="util active" id="feedback" href="https://chrome.google.com/extensions/detail/pemhgklkefakciniebenbfclihhmmfcd">
        <img src="img/feedback.png" alt="Feedback" />
        <span class="i18n" title="feedback"></span>
      </a>
      <a class="util active" id="options" href="options.htm">
        <img src="img/options.png" alt="Options" />
        <span class="i18n" title="options"></span>
      </a>
      <span class="util active" id="check_now">
        <img src="img/refresh.png" alt="Refresh" />
        <span class="i18n" title="check_all"></span>
      </span>
      <span class="util active" id="monitor_page">
        <img src="img/monitor.png" alt="Monitor" />
        <span class="i18n" title="monitor"></span>
      </span>
    </p>
  </body>
</html>